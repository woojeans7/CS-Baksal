# 캡슐화와 역캡슐화

상위 계층에서 하위 계층으로 데이터를 보내면 물리 계층에서 전기 신호 형태로 네트워크를 통해 신호를 보냄. 받는 쪽에서는 다시 하위 계층에서 상위 계층으로 데이터를 보냄.

이렇게 데이터를 보내는 과정을 **캡슐화(Encapsulation)**, 받는 과정을 **역캡슐화(Decapsulation)** 라고 한다.

## 캡슐화(Encapsulation)

데이터를 전송하는 쪽(송신 측)에서 데이터 송신시, 필요한 정보를 데이터에 추가하여 다음 계층으로 보낸다.
이러한 정보를 헤더(Header) 정보라고 하고, 실제 데이터를 바디(Body)라고 한다.

데이터를 하위 계층으로 내려보낼 때마다 문방구 캡슐에 포장해서 보낸다고 생각하면 됨.

- 송신 측
- 상위 → 하위
- 헤더를 추가

## 역캡슐화(Decapsulation)

데이터를 받는 쪽(수신 측)에서 데이터 수신시, 헤더를 제거하여 필요한 정보만 확인하고 해석한다.
최종적으로는 원본 데이터만 남는다.

역캡슐화는 반대로 문방구 캡슐을 까는 작업임.

- 수신 측
- 하위 → 상위
- 헤더를 제거

## 요약(Summary)

<img width="3364" height="2403" alt="image" src="https://github.com/user-attachments/assets/7f6a7865-2199-4915-bd7b-af04a1986cb2" />


### 계층별 데이터 단위

| 계층                | 데이터 단위                              | 추가되는 정보            |
| ------------------- | ---------------------------------------- | ------------------------ |
| 7계층 (응용)        | 데이터(Data)                             | -                        |
| 4계층 (전송)        | 세그먼트(Segment) / 데이터그램(Datagram) | TCP/UDP 헤더 (포트 번호) |
| 3계층 (네트워크)    | 패킷(Packet)                             | IP 헤더 (IP 주소)        |
| 2계층 (데이터 링크) | 프레임(Frame)                            | Ethernet 헤더 (MAC 주소) |
| 1계층 (물리)        | 비트(Bit)                                | 전기/광 신호로 변환      |

<br>

### 예시: HTTP 요청 전송

**캡슐화 과정:**

1. 응용 계층: `HTTP 요청 데이터`
2. 전송 계층: `[TCP 헤더 | HTTP 요청]` ← 포트 80 추가
3. 네트워크 계층: `[IP 헤더 | TCP 헤더 | HTTP 요청]` ← IP 주소 추가
4. 데이터 링크 계층: `[Ethernet | IP | TCP | HTTP | FCS]` ← MAC 주소 추가
5. 물리 계층: `01010101...` (비트로 변환)

<br>

**역캡슐화 과정:**

1. 물리 계층: 전기 신호 수신 → 프레임으로 변환
2. 데이터 링크 계층: Ethernet 헤더 확인 및 제거
3. 네트워크 계층: IP 헤더 확인 및 제거
4. 전송 계층: TCP 헤더 확인 및 제거
5. 응용 계층: HTTP 요청 데이터 획득
